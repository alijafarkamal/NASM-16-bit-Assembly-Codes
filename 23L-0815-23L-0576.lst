     1                                  [org 0x0100]
     2 00000000 B81300                   mov ax, 0x0013 
     3 00000003 CD10                     int 0x10 
     4 00000005 B800A0                   mov ax, 0xA000 
     5 00000008 8EC0                     mov es, ax 
     6 0000000A E9F407                       jmp start
     7 0000000D 457869743F2028792F-     exit_msg: db 'Exit? (y/n)', 0  ;
     7 00000016 6E2900             
     8 00000019 47616D6520456E6465-     game_ended_msg: db 'Game Ended. Press Key', 0
     8 00000022 642E20507265737320-
     8 0000002B 4B657900           
     9 0000002F 0000                    a_keeper: dw 0
    10 00000031 0000                    rect_mov_count: dw 0
    11 00000033 020A0C1C22              green_shades db 2, 10, 12, 28, 34 
    12 00000038 0000                    upperPillarHeight dw 0 
    13 0000003A 0000                    lowerPillarHeight dw 0 
    14 0000003C 0000                    bird_bottom_corner: dw 0
    15 0000003E 0000                    bird_bottom_corner_end: dw 0
    16 00000040 0000                    bird_top_corner: dw 0
    17 00000042 CC79                    bird_pos: dw 31180
    18 00000044 3F01CB01                pipesX: dw 319, 459
    19 00000048 14001400                pipesY: dw 20 , 20
    20 0000004C 0000                    leftOverPipeWidth: dw 0
    21 0000004E 0000                    leftOverPipeY: dw 0
    22 00000050 0000                    boolDrawBottomPipe: dw 0
    23 00000052 0000                    intBottomPipeStart: dw 0
    24 00000054 0000                    intPipeEndX: dw 0
    25 00000056 0000                    collision_detected: dw 0
    26 00000058 0000                    boolAdjusted: dw 0
    27 0000005A 0000                    boolFirstPipe: dw 0
    28 0000005C 0000                    rect_pos1: dw 0
    29 0000005E 0000                    rect_pos2: dw 0
    30 00000060 0000                    rect_pos_down: dw 0
    31 00000062 0000                    rect_pos_down1: dw 0
    32 00000064 0000                    rect_pos_down2: dw 0
    33 00000066 0000                    isAnimating: dw 0
    34 00000068 44                      BirdDirection: db 'D'
    35 00000069 0000                    bird_position_holder: dw 0
    36 0000006B 0000                    score :dw 0
    37 0000006D 0000                    game_end: dw 0
    38 0000006F 0000                    tickcount: dw 0
    39 00000071 00000000                old_timer:dw 0,0
    40 00000075 00000000                oldtimer : dw 0, 0
    41 00000079 4006                    delay_threshold dw 1600   
    42 0000007B 00                      timer_hooked db 0    
    43 0000007C 00                      is_flapping :db 0  
    44 0000007D 0000                    upper_pillar_helper: dw 0
    45 0000007F 417373656D626C6572-     GameTitle: db 'Assembler Aviator', 0
    45 00000088 2041766961746F7200 
    46 00000091 526F6C6C204E756D62-     RollNumbers: db 'Roll Numbers: 23L-0815, 23L-0576', 0
    46 0000009A 6572733A2032334C2D-
    46 000000A3 303831352C2032334C-
    46 000000AC 2D3035373600       
    47 000000B2 446576656C6F706564-     Names: db 'Developed by: Ali Jafar,Tayyab Khalil', 0
    47 000000BB 2062793A20416C6920-
    47 000000C4 4A616661722C546179-
    47 000000CD 796162204B68616C69-
    47 000000D6 6C00               
    48 000000D8 53656D65737465723A-     Semester: db 'Semester: Fall 2024', 0
    48 000000E1 2046616C6C20323032-
    48 000000EA 3400               
    49 000000EC 507265737320555020-     Instructions: db 'Press UP ARROW to move up,ESC to quit', 0
    49 000000F5 4152524F5720746F20-
    49 000000FE 6D6F76652075702C45-
    49 00000107 534320746F20717569-
    49 00000110 7400               
    50 00000112 496620455343206973-     Instructions1: db 'If ESC is pressed, game stops', 0
    50 0000011B 20707265737365642C-
    50 00000124 2067616D652073746F-
    50 0000012D 707300             
    51 00000130 496620792069732070-     Instructions2: db 'If y is pressed, it exits', 0
    51 00000139 7265737365642C2069-
    51 00000142 7420657869747300   
    52 0000014A 656C73652069742063-     Instructions3: db 'else it continues from where it stops', 0
    52 00000153 6F6E74696E75657320-
    52 0000015C 66726F6D2077686572-
    52 00000165 652069742073746F70-
    52 0000016E 7300               
    53 00000170 507265737320616E79-     StartMessage: db 'Press any key to start...', 0
    53 00000179 206B657920746F2073-
    53 00000182 746172742E2E2E00   
    54 0000018A 53636F72653A2000        cscore: db 'Score: ' ,0
    55                                  ; notes: dw 440, 494, 523, 587, 659, 698, 784  ; Frequencies for A4, B4, C5, etc.
    56                                  ; durations: dw 300, 300, 400, 300, 500, 300, 600 ; Durations in milliseconds
    57                                  ; note_count: dw 7                              ; Number of notes
    58 00000192 B41F2F15970A            notes: dw 0x1FB4, 0x152F, 0x0A97  ; Frequencies for D3, A3, and A4
    59 00000198 F401F401F401            durations: dw 500, 500, 500         ; Durations in milliseconds
    60 0000019E 0300                    note_count: dw 3                    ; Number of notes
    61 000001A0 0000                    current_note: dw 0                  ; Index of the current note
    62                                  ; pcb: times *2 dw 0 ; Allocate space for 2 tasks (game + music)
    63                                  
    64 000001A2 000000000000000000-     pcb: dw 0, 0, 0, 0, 0 ; task0 regs[cs:pcb + 0]
    64 000001AB 00                 
    65 000001AC 000000000000000000-     dw 0, 0, 0, 0, 0 ;
    65 000001B5 00                 
    66 000001B6 00                      current: db 0
    67                                  background:
    68 000001B7 0E                      push cs 
    69 000001B8 1F                      pop ds
    70 000001B9 06                      push es
    71 000001BA 31FF                        xor di, di
    72 000001BC B900FA                      mov cx, 320 * 200
    73 000001BF B002                        mov al, 2
    74 000001C1 F3AA                        rep stosb
    75 000001C3 07                      	pop es
    76 000001C4 C3                          ret
    77                                  DisplayIntroduction:
    78                                  
    79 000001C5 0E                      push cs 
    80 000001C6 1F                      pop ds
    81 000001C7 06                      push es
    82 000001C8 E8ECFF                      call background
    83 000001CB B607                        mov dh, 7
    84 000001CD B203                        mov dl, 3
    85 000001CF BE[7F00]                    mov si, GameTitle
    86 000001D2 E82A00                      call PrintStringAtPosition
    87 000001D5 B609                        mov dh, 9
    88 000001D7 BE[9100]                    mov si, RollNumbers
    89 000001DA E82200                      call PrintStringAtPosition
    90                                  
    91 000001DD B60B                        mov dh, 11
    92 000001DF BE[B200]                    mov si, Names
    93 000001E2 E81A00                      call PrintStringAtPosition
    94                                  
    95 000001E5 B60D                        mov dh, 13
    96 000001E7 BE[D800]                    mov si, Semester
    97 000001EA E81200                      call PrintStringAtPosition
    98                                  
    99 000001ED B60F                        mov dh, 15
   100 000001EF BE[EC00]                    mov si, Instructions
   101 000001F2 E80A00                      call PrintStringAtPosition
   102                                  
   103 000001F5 B611                        mov dh, 17
   104 000001F7 BE[7001]                    mov si, StartMessage
   105 000001FA E80200                      call PrintStringAtPosition
   106 000001FD 07                      	pop es
   107 000001FE C3                          ret
   108                                  
   109                                  PrintStringAtPosition:
   110                                  
   111 000001FF 0E                      push cs 
   112 00000200 1F                      pop ds
   113 00000201 06                      push es
   114 00000202 60                          pusha
   115 00000203 B402                        mov ah, 02h
   116 00000205 CD10                        int 10h
   117 00000207 B40E                        mov ah, 0Eh
   118 00000209 B700                        mov bh, 0
   119 0000020B B30F                        mov bl, 15
   120                                  
   121                                  print_position_loop:
   122 0000020D AC                          lodsb
   123 0000020E 3C00                        cmp al, 0
   124 00000210 7404                        je done_position_print
   125 00000212 CD10                        int 10h
   126 00000214 EBF7                        jmp print_position_loop
   127                                  
   128                                  done_position_print:
   129 00000216 61                          popa
   130 00000217 07                      	pop es
   131 00000218 C3                          ret
   132                                  
   133                                  collision:
   134 00000219 FA                      cli
   135 0000021A 0E                      push cs 
   136 0000021B 1F                      pop ds
   137                                  ;push es
   138 0000021C 60                      pusha
   139 0000021D 813E[4200]9600           cmp word[bird_pos],150
   140 00000223 7708                     ja next_check
   141 00000225 C706[5600]0100           mov word[collision_detected],1
   142 0000022B EB14                     jmp get_out
   143                                  next_check:
   144 0000022D 8B3E[3E00]              mov di, word[bird_bottom_corner_end]
   145 00000231 81C74001                add di,320
   146 00000235 81FF00E1                 cmp di,57600
   147 00000239 7206                     jb get_out
   148 0000023B C706[5600]0100           mov word[collision_detected],1
   149                                  get_out: 
   150 00000241 61                      popa
   151                                  ;pop es
   152 00000242 C3                      ret
   153                                  
   154                                  
   155                                  ShowExitConfirmation:
   156 00000243 0E                      push cs 
   157 00000244 1F                      pop ds
   158 00000245 B402                        mov ah, 02h                
   159 00000247 B700                        mov bh, 0                   
   160 00000249 B618                        mov dh, 24                  ; Row (adjust as needed)
   161 0000024B B20F                        mov dl, 15                  ; Column (adjust as needed)
   162 0000024D CD10                        int 10h
   163                                  
   164 0000024F B40E                        mov ah, 0Eh                 ; BIOS teletype function
   165 00000251 B700                        mov bh, 0                   ; Page number
   166 00000253 B302                        mov bl, 2                  ; White text
   167 00000255 BE[0D00]                    mov si, exit_msg            ; Pointer to message
   168                                  
   169                                  print_message_text:
   170 00000258 AC                          lodsb                      
   171 00000259 3C00                        cmp al, 0
   172 0000025B 7404                        je wait_for_key1
   173 0000025D CD10                        int 10h                   
   174 0000025F EBF7                        jmp print_message_text
   175                                  
   176                                  wait_for_key1:
   177 00000261 0E                      push cs 
   178 00000262 1F                      pop ds
   179 00000263 B400                        mov ah, 0
   180 00000265 CD16                        int 16h                     ; Get key in AL
   181 00000267 3C79                        cmp al, 'y'                 ; Check if 'y' or 'Y'
   182 00000269 741C                        je exit_game
   183 0000026B 3C59                        cmp al, 'Y'
   184 0000026D 7418                        je exit_game
   185                                  end_erase:
   186 0000026F BB0A00                  	mov bx,10
   187 00000272 BFF8ED                  	mov di,60920
   188                                  exit_loop:
   189 00000275 B95800                  	mov cx,88
   190 00000278 B006                    	mov al,6
   191 0000027A F3AA                    	rep stosb
   192 0000027C 4B                      	dec bx
   193 0000027D 81C7E800                	add di,232
   194 00000281 83FB00                  	cmp bx,0
   195 00000284 75EF                    jne exit_loop
   196 00000286 C3                          ret
   197                                  exit_game:  
   198 00000287 C706[6D00]0100          mov word[game_end],1
   199                                  
   200 0000028D B0FD                        mov al, 11111101b    
   201 0000028F E461                        in  al, 61h          
   202 00000291 24FC                        and al, 11111100b    
   203 00000293 E661                        out 61h, al          
   204 00000295 B0B6                        mov al, 10110110b    
   205 00000297 E643                        out 43h, al          
   206 00000299 B000                        mov al, 0            
   207 0000029B E642                        out 42h, al          
   208 0000029D B000                    	 mov al, 0           
   209 0000029F E642                        out 42h, al          
   210                                      ; Wait for a keypress
   211                                  wait_for_key:
   212 000002A1 B400                        mov ah, 0                      ; BIOS keyboard function
   213 000002A3 CD16                        int 16h                        ; Wait for key
   214                                  
   215                                      ; Clear the stack and prepare for a clean exit
   216                                  reset_stack:
   217 000002A5 FA                          cli                            ; Disable interrupts
   218 000002A6 31C0                        xor ax, ax                     ; AX = 0
   219 000002A8 8ED0                        mov ss, ax                     ; Reset stack segment to 0
   220 000002AA BCFEFF                      mov sp, 0xFFFE                 ; Set stack pointer to a safe high value
   221 000002AD FB                          sti                            ; Re-enable interrupts
   222                                  
   223                                      ; Restore video mode to text mode 03h (80x25 color text)
   224 000002AE B80300                      mov ax, 0x0003                 ; Set video mode 03h
   225 000002B1 CD10                        int 0x10                       ; Call BIOS to restore text mode
   226                                  
   227                                      ; Forcefully restore all critical interrupt vectors
   228 000002B3 31C0                        xor ax, ax                     ; AX = 0
   229 000002B5 8EC0                        mov es, ax                     ; ES = 0 (interrupt vector table segment)
   230                                  
   231                                      ; Restore default INT 9h (keyboard interrupt) to BIOS
   232                                      ;mov word [es:9*4], 0x1C        ; Default offset for keyboard handler
   233                                      ;mov word [es:9*4+2], 0xF000    ; Default segment for keyboard handler
   234 000002B7 A1[7500]                mov ax,[oldtimer]
   235 000002BA 8B1E[7700]              mov bx,[oldtimer+2]
   236 000002BE 26A32000                     mov word [es:8*4],ax 
   237 000002C2 26891E2200                   mov [es:8*4+2], bx
   238                                  ; mov byte [cs:dead], 1  ; Stop the sound
   239                                      ; Stop the sound by disabling the speaker
   240 000002C7 B400                        mov ah, 0                      ; BIOS keyboard function
   241 000002C9 CD16                        int 16h                        ; Clear buffer with wait
   242 000002CB B401                        mov ah, 1
   243 000002CD CD16                        int 16h                        ; Test for a keypress
   244 000002CF 7406                        jz no_more_keys
   245                                  clear_keys:
   246 000002D1 B400                        mov ah, 0
   247 000002D3 CD16                        int 16h                        ; Read and discard key
   248 000002D5 EB00                        jmp no_more_keys
   249                                  no_more_keys:
   250                                  
   251 000002D7 B020                        mov al, 20h                    ; End-of-Interrupt command
   252 000002D9 E620                        out 20h, al                    ; Send to PIC
   253 000002DB B9FFFF                      mov cx, 0FFFFh                 ; Arbitrary delay
   254                                  delay_loop:
   255 000002DE E2FE                        loop delay_loop
   256 000002E0 E97705                  jmp ll2
   257                                      ; Terminate program and return to DOS
   258 000002E3 B8004C                      mov ax, 0x4C00                 ; DOS terminate program function
   259 000002E6 CD21                        int 0x21                       ; Exit program and return to DOS
   260                                  
   261                                  
   262                                  
   263                                  upper_part:
   264 000002E8 0E                      push cs 
   265 000002E9 1F                      pop ds
   266 000002EA 06                      push es
   267 000002EB 31FF                        xor di, di
   268 000002ED B035                        mov al, 35h
   269 000002EF B9004B                      mov cx, 320 * 60
   270 000002F2 F3AA                        rep stosb
   271 000002F4 07                      	pop es
   272 000002F5 C3                          ret
   273                                  
   274                                  medium_part:
   275 000002F6 0E                      push cs 
   276 000002F7 1F                      pop ds
   277 000002F8 06                      push es
   278 000002F9 BF004B                      mov di, 320 * 60
   279 000002FC B035                        mov al, 35h
   280 000002FE B96054                      mov cx, 360 * 60
   281 00000301 F3AA                        rep stosb
   282 00000303 07                      	pop es
   283 00000304 C3                          ret
   284                                  
   285                                  lower_part:
   286 00000305 0E                      push cs 
   287 00000306 1F                      pop ds
   288 00000307 06                      push es
   289 00000308 BF0096                      mov di, 320 * 120
   290 0000030B B035                        mov al, 35h
   291 0000030D B90064                      mov cx, 320 * 80
   292 00000310 F3AA                        rep stosb
   293 00000312 07                      	pop es
   294 00000313 C3                          ret
   295                                  
   296                                  sscore:
   297 00000314 0E                      push cs 
   298 00000315 1F                      pop ds
   299 00000316 06                      push es
   300 00000317 60                          pusha
   301 00000318 BE[8A01]                    mov si, cscore
   302 0000031B B402                        mov ah, 02h
   303 0000031D B700                        mov bh, 0
   304 0000031F B618                        mov dh, 24
   305 00000321 B201                        mov dl, 1
   306 00000323 CD10                        int 10h
   307 00000325 B40E                        mov ah, 0Eh
   308 00000327 B700                        mov bh, 0
   309 00000329 B30F                        mov bl, 15
   310                                  
   311                                  print_scoer:
   312 0000032B AC                          lodsb
   313 0000032C 3C00                        cmp al, 0
   314 0000032E 7404                        je done_
   315 00000330 CD10                        int 10h
   316 00000332 EBF7                        jmp print_scoer
   317                                  
   318                                  done_:
   319 00000334 61                          popa
   320 00000335 07                      	pop es
   321 00000336 C3                          ret
   322                                  
   323                                  cal_dig:
   324                                  
   325 00000337 E8DAFF                      call sscore
   326 0000033A 0E                      	push cs 
   327 0000033B 1F                      pop ds
   328 0000033C 06                      push es
   329 0000033D A1[6B00]                    mov ax, [score]
   330 00000340 3DE803                  	cmp ax,1000
   331 00000343 7402                    	je movv
   332 00000345 7503                    	jne movv1
   333                                  	movv:
   334 00000347 B80000                  	mov ax,0
   335                                  	movv1:
   336 0000034A 31C9                        xor cx, cx
   337 0000034C BB0A00                      mov bx, 10
   338                                  store_digits:
   339 0000034F 0E                      push cs 
   340 00000350 1F                      pop ds
   341 00000351 31D2                        xor dx, dx
   342 00000353 F7F3                        div bx
   343 00000355 52                          push dx
   344 00000356 41                          inc cx
   345 00000357 83F800                      cmp ax, 0
   346 0000035A 75F3                        jnz store_digits
   347                                  
   348                                  draw_score:
   349 0000035C 0E                      push cs 
   350 0000035D 1F                      pop ds
   351 0000035E B402                        mov ah, 02h
   352 00000360 B700                        mov bh, 0
   353 00000362 B618                        mov dh, 24
   354 00000364 B208                        mov dl, 8
   355 00000366 CD10                        int 10h
   356                                  
   357                                  print_digits:
   358                                  
   359 00000368 5A                          pop dx
   360 00000369 80C230                      add dl, 0x30
   361 0000036C 88D0                        mov al, dl
   362 0000036E B40E                        mov ah, 0Eh
   363 00000370 B700                        mov bh, 0
   364 00000372 CD10                        int 10h
   365 00000374 FEC2                        inc dl
   366 00000376 E2F0                        loop print_digits
   367 00000378 07                      	pop es
   368 00000379 C3                          ret    
   369                                  
   370                                  
   371                                  bird_body:
   372 0000037A 0E                      push cs 
   373 0000037B 1F                      pop ds
   374 0000037C 06                      push es
   375 0000037D 60                          pusha
   376 0000037E BB0C00                      mov bx,12 
   377 00000381 8B36[4200]                  mov si, [bird_pos] 
   378 00000385 83C612                      add si,18
   379 00000388 8936[4000]                  mov word[bird_top_corner],si
   380 0000038C 83EE12                      sub si,18
   381                                  body:
   382 0000038F 89F7                        mov di, si
   383 00000391 B00E                        mov al, 14 
   384 00000393 B91200                      mov cx, 18 
   385 00000396 F3AA                        rep stosb
   386 00000398 83EB01                      sub bx,1
   387 0000039B 81C64001                    add si, 320
   388 0000039F 83FB00                      cmp bx, 0 
   389 000003A2 75EB                        jnz body
   390 000003A4 57                      	push di
   391 000003A5 8B3E[4200]              	mov di,[bird_pos]
   392 000003A9 81C74806                	add di,1608
   393 000003AD B0CC                    	mov al,  0xCC
   394 000003AF AA                      	stosb
   395 000003B0 47                      	inc di
   396 000003B1 AA                      	stosb
   397 000003B2 47                      	inc di
   398 000003B3 AA                      	stosb
   399 000003B4 5F                      	pop di
   400 000003B5 81EE4001                    sub si,320
   401 000003B9 8936[3C00]                  mov word[bird_bottom_corner],si
   402 000003BD 83C612                      add si,18
   403 000003C0 8936[3E00]                  mov word[bird_bottom_corner_end],si
   404 000003C4 83EE12                      sub si,18
   405 000003C7 8936[6900]                  mov [bird_position_holder],si
   406 000003CB 61                          popa
   407 000003CC 07                      pop es	
   408 000003CD C3                          ret 
   409                                  
   410                                  defDrawPipe:
   411 000003CE 55                          push bp
   412 000003CF 89E5                        mov bp, sp
   413 000003D1 60                          pusha
   414 000003D2 8B4E04                      mov cx, [bp+4]
   415 000003D5 BA0000                      mov dx, 0
   416 000003D8 B40C                        mov ah, 0ch
   417 000003DA 8B5E06                      mov bx, [bp+6]
   418 000003DD 891E[5200]                  mov word [intBottomPipeStart], bx
   419 000003E1 8306[5200]37                add word [intBottomPipeStart], 55
   420 000003E6 C706[5000]0000              mov word [boolDrawBottomPipe], 0
   421 000003EC 890E[5400]                  mov word [intPipeEndX], cx
   422 000003F0 8306[5400]28                add word [intPipeEndX], 40
   423 000003F5 837E0801                    cmp word [bp+8], 1
   424 000003F9 741F                        je drawTopPipe
   425 000003FB 833E[4C00]00                cmp word [leftOverPipeWidth], 0
   426 00000400 7647                        jbe endDrawPipe
   427 00000402 8B0E[4C00]                  mov cx, [leftOverPipeWidth]
   428 00000406 890E[5400]                  mov word [intPipeEndX], cx
   429 0000040A B92800                      mov cx, 40
   430 0000040D 2B0E[4C00]                  sub cx, [leftOverPipeWidth]
   431 00000411 01CB                        add bx, cx
   432 00000413 B90000                      mov cx, 0
   433 00000416 FF0E[4C00]                  dec word [leftOverPipeWidth]
   434                                  drawTopPipe:
   435 0000041A B002                        mov al,2
   436                                  colorSelected:
   437 0000041C 81F94001                    cmp cx, 320
   438 00000420 7327                        jae endDrawPipe
   439 00000422 83F900                      cmp cx, 0
   440 00000425 7222                        jb endDrawPipe
   441 00000427 CD10                        int 10h
   442                                  skipPipe:
   443 00000429 42                          inc dx
   444 0000042A 3B5606                      cmp dx, [bp+6]
   445 0000042D 76EB                        jbe drawTopPipe
   446 0000042F 3B16[5200]                  cmp dx, [intBottomPipeStart]
   447 00000433 7703                        ja notSkip
   448 00000435 83C236                      add dx, 54
   449                                  notSkip:
   450 00000438 81FAB400                    cmp dx, 180
   451 0000043C 72DC                        jb drawTopPipe
   452 0000043E 41                          inc cx
   453 0000043F BA0000                      mov dx, 0
   454 00000442 43                          inc bx
   455 00000443 3B0E[5400]                  cmp cx, [intPipeEndX]
   456 00000447 72D1                        jb drawTopPipe
   457                                  endDrawPipe:
   458 00000449 61                          popa 
   459 0000044A 5D                          pop bp
   460                                  	;pop es
   461 0000044B C20600                      ret 6
   462                                  movePipe:
   463 0000044E 0E                      push cs 
   464 0000044F 1F                      pop ds
   465 00000450 55                          push bp
   466 00000451 89E5                        mov bp, sp
   467 00000453 60                          pusha
   468 00000454 FF06[3100]                  inc word[rect_mov_count]
   469 00000458 813E[3100]4501              cmp word[rect_mov_count],325
   470 0000045E 7402                        je incc
   471 00000460 750D                        jne noincc
   472                                  incc:
   473 00000462 C706[3100]0000              mov word[rect_mov_count],0
   474 00000468 FF06[6B00]                  inc word[score]
   475 0000046C E8C8FE                      call cal_dig
   476                                  noincc:
   477 0000046F 8B5E04                      mov bx, [bp+4]
   478 00000472 FF0F                        dec word [bx]
   479 00000474 8B0F                        mov cx, [bx]
   480 00000476 83C129                      add cx,41
   481 00000479 C706[5800]0000              mov word [boolAdjusted], 0
   482 0000047F 81F94001                    cmp cx, 320
   483 00000483 7D02                        jge adjustX
   484 00000485 EB0A                        jmp continueDrawing
   485                                  adjustX:
   486 00000487 81E94001                    sub word cx, 320
   487 0000048B C706[5800]0100              mov word [boolAdjusted], 1
   488                                  continueDrawing:
   489 00000491 BA0000                      mov dx,0
   490 00000494 B035                        mov al,35h
   491 00000496 B40C                        mov ah,0ch
   492 00000498 8B7606                      mov si,[bp+6]
   493                                  drawLastColumnSky:
   494 0000049B CD10                        int 10h
   495 0000049D 3E3B14                      cmp dx, [ds:si]
   496 000004A0 7516                        jne continueDrawingSky
   497 000004A2 833E[5800]00                cmp word [boolAdjusted], 0
   498 000004A7 7405                        je notCheckForadjusted
   499 000004A9 83F929                      cmp cx,41
   500 000004AC 7711                        ja skipSkyColumn
   501                                  notCheckForadjusted:
   502 000004AE 83F929                      cmp cx,41
   503 000004B1 7205                        jb continueDrawingSky
   504 000004B3 83C237                      add dx, 55
   505 000004B6 EBE3                        jmp drawLastColumnSky
   506                                  continueDrawingSky:
   507 000004B8 42                          inc dx
   508 000004B9 81FAB400                    cmp dx,180
   509 000004BD 72DC                        jb drawLastColumnSky
   510                                  skipSkyColumn:
   511 000004BF 83E929                      sub cx,41
   512 000004C2 83F900                      cmp cx,0
   513 000004C5 7524                        jne endMovePipe
   514 000004C7 833E[4400]00                cmp word [pipesX], 0
   515 000004CC 7506                        jne endMovePipeContinue
   516 000004CE C706[5A00]0100              mov word [boolFirstPipe], 1
   517                                  endMovePipeContinue:
   518 000004D4 C706[4C00]2800              mov word [leftOverPipeWidth], 40
   519 000004DA 3E8B0C                      mov cx, [ds:si]
   520 000004DD 890E[4E00]                  mov word [leftOverPipeY], cx
   521 000004E1 C7074001                    mov word [bx], 320
   522 000004E5 FF7606                      push word [bp+6]
   523 000004E8 E80500                      call generateRandomNumber
   524                                  endMovePipe:
   525 000004EB 61                          popa
   526 000004EC 5D                          pop bp
   527 000004ED C20200                      ret 2
   528                                  generateRandomNumber:
   529 000004F0 0E                      push cs 
   530 000004F1 1F                      pop ds
   531 000004F2 55                          push bp
   532 000004F3 89E5                        mov bp, sp
   533 000004F5 60                          pusha
   534 000004F6 B400                        mov ah,0
   535 000004F8 CD1A                        int 1ah
   536 000004FA 89D0                        mov ax,dx
   537 000004FC BB3C00                      mov bx,60
   538 000004FF BA0000                      mov dx,0
   539 00000502 F7F3                        div bx
   540 00000504 8B5E04                      mov bx, [bp+4]
   541 00000507 8917                        mov word [bx], dx
   542 00000509 830714                      add word [bx], 20
   543 0000050C 61                          popa
   544 0000050D 5D                          pop bp
   545 0000050E C20200                      ret 2
   546                                  
   547                                  ground:
   548 00000511 0E                      push cs 
   549 00000512 1F                      pop ds
   550 00000513 06                      push es
   551 00000514 BF00E1                      mov di, 57600
   552 00000517 B9800C                      mov cx, 320 * 10
   553 0000051A BB0100                      mov bx, 1
   554                                  .draw_gradient:
   555 0000051D 8A87[3300]                  mov al, [green_shades+bx]
   556 00000521 AA                          stosb
   557 00000522 43                          inc bx
   558 00000523 83FB04                      cmp bx, 4
   559 00000526 7503                        jne .continue_gradient
   560 00000528 BB0100                      mov bx, 1
   561                                  .continue_gradient:
   562 0000052B E2F0                        loop .draw_gradient
   563 0000052D BF80ED                      mov di, 60800
   564 00000530 B006                        mov al, 6
   565 00000532 B9800C                      mov cx, 320 * 10
   566 00000535 F3AA                        rep stosb
   567 00000537 07                      	pop es
   568 00000538 C3                          ret
   569                                  
   570                                  
   571                                  delay:
   572 00000539 0E                      push cs 
   573 0000053A 1F                      pop ds
   574 0000053B 60                       pusha
   575 0000053C B900FA                   mov cx,64000
   576                                  delay1:
   577 0000053F E2FE                     loop delay1
   578 00000541 61                       popa
   579 00000542 C3                       ret
   580                                  
   581                                  
   582                                  
   583                                  remover_bird:
   584 00000543 0E                      push cs 
   585 00000544 1F                      pop ds
   586 00000545 60                       pusha
   587 00000546 89F7                     mov di,si
   588 00000548 B035                     mov al,35h
   589 0000054A B91200                   mov cx,18
   590 0000054D F3AA                     rep stosb
   591 0000054F 61                       popa
   592 00000550 C3                       ret
   593                                  
   594                                  
   595                                  
   596                                  bird_falling:
   597 00000551 0E                      push cs 
   598 00000552 1F                      pop ds
   599 00000553 60                      pusha
   600 00000554 B800A0                  mov ax,0xA000
   601 00000557 8EC0                    mov es,ax
   602 00000559 57                      push di
   603 0000055A 8B3E[4000]              mov di,[bird_top_corner]
   604 0000055E 26803D02                cmp byte[es:di],2
   605 00000562 742B                    je exit_game_1
   606 00000564 8B3E[3C00]              mov di,[bird_bottom_corner]
   607 00000568 2680BD400102            cmp byte[es:di+320],2
   608 0000056E 741F                    je exit_game_1
   609 00000570 8B3E[3E00]              mov di,[bird_bottom_corner_end]
   610 00000574 2680BD400102            cmp byte[es:di+320],2
   611 0000057A 7413                    je exit_game_1
   612 0000057C 5F                      pop di
   613 0000057D 8B36[4200]               mov si,word[bird_pos]
   614 00000581 E8BFFF                   call remover_bird
   615 00000584 8106[4200]4001           add word[bird_pos],320
   616 0000058A E8EDFD                   call bird_body
   617 0000058D EB07                    jmp outr
   618                                  exit_game_1:
   619 0000058F C706[5600]0100          mov word[collision_detected],1
   620 00000595 5F                      pop di
   621                                  outr:
   622 00000596 61                       popa
   623 00000597 C3                       ret
   624                                  
   625                                  moving_up:
   626 00000598 0E                      push cs 
   627 00000599 1F                      pop ds
   628 0000059A 60                       pusha
   629 0000059B B800A0                  mov ax,0xA000
   630 0000059E 8EC0                    mov es,ax
   631 000005A0 57                      push di
   632 000005A1 8B3E[4000]              mov di,[bird_top_corner]
   633 000005A5 2680BDC0FE02            cmp byte[es:di-320],2
   634 000005AB 7429                    je exit_game_2
   635 000005AD 8B3E[3E00]              mov di,[bird_bottom_corner_end]
   636 000005B1 26803D02                cmp byte[es:di],2
   637 000005B5 741F                    je exit_game_2
   638 000005B7 8B3E[4200]              mov di,[bird_pos]
   639 000005BB 2680BDC0FE02            cmp byte[es:di-320],2
   640 000005C1 7413                    je exit_game_2
   641 000005C3 5F                      pop di
   642                                  
   643 000005C4 812E[4200]4001           sub word[bird_pos],320
   644 000005CA 8B36[6900]               mov si,[bird_position_holder]
   645 000005CE E872FF                   call remover_bird
   646 000005D1 E8A6FD                   call bird_body
   647 000005D4 EB07                    jmp outrr
   648                                  exit_game_2:
   649 000005D6 C706[5600]0100          mov word[collision_detected],1
   650 000005DC 5F                      pop di
   651                                  outrr:
   652 000005DD 61                       popa
   653 000005DE C3                       ret
   654                                  
   655                                  bird_falling_collide:
   656 000005DF 0E                      push cs 
   657 000005E0 1F                      pop ds
   658 000005E1 60                      pusha
   659 000005E2 8B36[4200]               mov si,word[bird_pos]
   660 000005E6 E85AFF                   call remover_bird
   661 000005E9 8106[4200]4001           add word[bird_pos],320
   662 000005EF E888FD                   call bird_body
   663 000005F2 61                       popa
   664 000005F3 C3                       ret
   665                                  
   666                                  remover_extra:
   667 000005F4 0E                      push cs 
   668 000005F5 1F                      pop ds
   669 000005F6 60                      pusha
   670 000005F7 8B3E[4200]               mov di,[bird_pos]
   671 000005FB B90C00                  mov cx,12
   672 000005FE B035                     mov al,35h
   673                                  l2:
   674 00000600 AA                       stosb
   675 00000601 81C73F01                 add di,319
   676 00000605 E2F9                    loop l2
   677 00000607 61                       popa
   678 00000608 C3                       ret
   679                                  
   680                                  
   681                                  collide_extra:
   682 00000609 0E                      push cs 
   683 0000060A 1F                      pop ds
   684 0000060B 60                      pusha
   685                                  l1:
   686 0000060C E8E5FF                  call remover_extra
   687 0000060F 8306[4200]01            add word[bird_pos],1
   688 00000614 E822FF                  call delay
   689 00000617 E81FFF                  call delay
   690 0000061A E85DFD                  call bird_body
   691 0000061D 8B3E[3C00]              mov di,[bird_bottom_corner]
   692 00000621 2680BD400102            cmp byte[es:di+320],2
   693 00000627 74E3                    je l1
   694 00000629 61                      popa
   695 0000062A C3                      ret
   696                                  
   697                                  Collider:
   698 0000062B B0FD                        mov al, 11111101b    ; Clear bit 1 (Speaker Gate)
   699 0000062D E461                        in  al, 61h          ; Read current state of port 61h
   700 0000062F 24FC                        and al, 11111100b    ; Clear speaker bits
   701 00000631 E661                        out 61h, al          ; Write back to port 61h
   702 00000633 B0B6                        mov al, 10110110b    ; Control word: Select Channel 2, Latch Command
   703 00000635 E643                        out 43h, al          ; Send control word to PIT command register
   704 00000637 B000                        mov al, 0            ; Send initial count low byte
   705 00000639 E642                        out 42h, al          ; Write to Channel 2 data port
   706 0000063B B000                        mov al, 0            ; Send initial count high byte
   707 0000063D E642                        out 42h, al
   708 0000063F 0E                      push cs 
   709 00000640 1F                      pop ds
   710                                  iteration:
   711 00000641 60                      pusha
   712 00000642 B800A0                  mov ax,0xA000
   713 00000645 8EC0                    mov es,ax
   714 00000647 8B3E[3E00]              mov di,[bird_bottom_corner_end]
   715 0000064B 2680BD3E0102            cmp byte[es:di+318],2
   716 00000651 741D                    je outrrr
   717 00000653 8B3E[3C00]              mov di,[bird_bottom_corner]
   718 00000657 2680BD400102            cmp byte[es:di+320],2
   719 0000065D 7411                    je outrrr
   720 0000065F 61                      popa
   721 00000660 E8D6FE                  call delay
   722 00000663 E879FF                  call bird_falling_collide
   723 00000666 813E[3E00]00E1          cmp word[bird_bottom_corner_end],57600
   724 0000066C 72D3                    jb iteration
   725 0000066E EB07                    jmp labela
   726                                  outrrr:
   727 00000670 E896FF                  call collide_extra
   728 00000673 61                      popa
   729 00000674 E8B4FF                  call Collider
   730                                  labela:
   731 00000677 E8BFFE                  call delay
   732 0000067A E8BCFE                  call delay
   733 0000067D E807FC                  call exit_game
   734 00000680 C3                      ret
   735                                  
   736                                  HandleKeyPress:
   737 00000681 0E                      push cs 
   738 00000682 1F                      pop ds
   739 00000683 50                          push ax
   740 00000684 53                          push bx
   741 00000685 51                          push cx
   742 00000686 52                          push dx
   743 00000687 B401                        mov ah, 1          
   744 00000689 CD16                        int 0x16
   745 0000068B 7442                        jz no_key_pressed  
   746 0000068D B400                        mov ah, 0          
   747 0000068F CD16                        int 0x16
   748 00000691 80FC01                      cmp ah, 0x01          
   749 00000694 740C                        je exit_game_press
   750                                  
   751 00000696 80FC48                      cmp ah, 0x48          
   752 00000699 740C                        je handle_up
   753                                  
   754 0000069B 80FCC8                      cmp ah, 0xC8          
   755 0000069E 7418                        je handle_release
   756                                  
   757 000006A0 EB2D                        jmp no_key_pressed    
   758                                  
   759                                  exit_game_press:
   760 000006A2 E89EFB                      call ShowExitConfirmation
   761 000006A5 EB2B                        jmp out_of
   762                                  
   763                                  handle_up:
   764 000006A7 C706[7C00]0100              mov word [is_flapping], 1  
   765 000006AD C706[6F00]0000              mov word [tickcount], 0    
   766 000006B3 E8E2FE                      call moving_up             
   767 000006B6 EB1A                        jmp out_of
   768                                  handle_release:
   769 000006B8 803E[7B00]01                cmp byte [timer_hooked], 1 
   770 000006BD 7413                        je out_of                  
   771 000006BF C606[7B00]01                mov byte [timer_hooked], 1 
   772 000006C4 E81000                      call hook_timer            
   773 000006C7 C706[7C00]0000              mov word [is_flapping], 0  
   774 000006CD EB03                        jmp out_of
   775                                  no_key_pressed:
   776 000006CF E87FFE                      call bird_falling
   777                                  out_of:
   778 000006D2 5A                          pop dx
   779 000006D3 59                          pop cx
   780 000006D4 5B                          pop bx
   781 000006D5 58                          pop ax
   782 000006D6 C3                          ret
   783                                  
   784                                  
   785                                  hook_timer:
   786 000006D7 0E                      push cs 
   787 000006D8 1F                      pop ds
   788 000006D9 FA                          cli                        
   789 000006DA 1E                          push ds
   790 000006DB 31C0                        xor ax, ax
   791 000006DD 8EC0                        mov es, ax
   792 000006DF 26A12000                    mov ax, word [es:8*4]
   793 000006E3 A3[7100]                    mov word [old_timer], ax
   794 000006E6 26A12200                    mov ax, word [es:8*4+2]
   795 000006EA A3[7300]                    mov word [old_timer+2], ax
   796 000006ED A1[7900]                    mov ax, [delay_threshold]
   797 000006F0 26C7062000[FF06]            mov word [es:8*4], timr
   798 000006F7 268C0E2200                  mov word [es:8*4+2], cs
   799 000006FC 1F                          pop ds
   800 000006FD FB                          sti
   801 000006FE C3                          ret
   802                                  
   803                                  timr:
   804 000006FF 0E                      push cs 
   805 00000700 1F                      pop ds
   806 00000701 50                          push ax
   807 00000702 53                          push bx
   808 00000703 51                          push cx
   809 00000704 52                          push dx
   810 00000705 FF06[6F00]                  inc word [tickcount]
   811 00000709 3906[6F00]                  cmp word [tickcount], ax
   812 0000070D 7511                        jne end_timer
   813 0000070F C706[6F00]0000              mov word [tickcount], 0
   814 00000715 E839FE                      call bird_falling
   815 00000718 C606[7B00]00                mov byte [timer_hooked], 0
   816 0000071D E80900                      call unhook_timer
   817                                  end_timer:
   818 00000720 B020                        mov al, 0x20
   819 00000722 E620                        out 0x20, al
   820 00000724 5A                          pop dx
   821 00000725 59                          pop cx
   822 00000726 5B                          pop bx
   823 00000727 58                          pop ax
   824 00000728 CF                          iret
   825                                  
   826                                  unhook_timer:
   827 00000729 0E                      push cs 
   828 0000072A 1F                      pop ds
   829 0000072B FA                          cli
   830 0000072C 1E                          push ds
   831 0000072D 31C0                        xor ax, ax
   832 0000072F 8EC0                        mov es, ax
   833 00000731 A1[7100]                    mov ax, word [old_timer]
   834 00000734 26A32000                    mov word [es:8*4], ax
   835 00000738 A1[7300]                    mov ax, word [old_timer+2]
   836 0000073B 26A32200                    mov word [es:8*4+2], ax
   837 0000073F 1F                          pop ds
   838 00000740 FB                          sti
   839 00000741 C3                          ret
   840                                  
   841                                  ground_mover:
   842 00000742 0E                      push cs 
   843 00000743 1F                      pop ds
   844 00000744 60                       pusha
   845 00000745 1E                       push ds
   846 00000746 06                       push es
   847 00000747 B800A0                   mov ax,0xA000
   848 0000074A 8ED8                     mov ds,ax
   849 0000074C BF00E1                   mov di,57600
   850 0000074F BE02E1                   mov si,57602
   851 00000752 B97E0C                   mov cx,3198
   852 00000755 F3A4                     rep movsb
   853 00000757 07                       pop es
   854 00000758 1F                       pop ds
   855 00000759 61                       popa
   856 0000075A C3                       ret
   857                                  
   858                                  PrintStartScreen:
   859 0000075B E88AFB                   call upper_part  
   860 0000075E E895FB                   call medium_part
   861 00000761 E8A1FB                   call lower_part
   862 00000764 E813FC                   call bird_body
   863 00000767 E8A7FD                   call ground
   864 0000076A C3                       ret
   865                                  
   866                                  anime:
   867 0000076B E8A6FB                  	call sscore
   868                                  
   869                                  main_loop:
   870 0000076E E8C8FD                  	call delay
   871 00000771 E8C5FD                  	call delay
   872 00000774 E80AFF                      call HandleKeyPress 
   873 00000777 E89FFA                  	call collision
   874 0000077A 833E[5600]01            	cmp word[collision_detected],1
   875 0000077F 0F84A8FE                	je Collider
   876 00000783 C706[5600]0000          	mov word[collision_detected],0
   877                                  continue_loop:
   878 00000789 B800A0                  mov ax,0xA000
   879 0000078C 8ED8                    mov ds,ax
   880 0000078E 68[4800]                    push pipesY ; y-coordinate address of pipe
   881 00000791 68[4400]                    push pipesX ; x-coordinate address of pipe    
   882 00000794 E8B7FC                      call movePipe
   883                                  
   884 00000797 68[4A00]                    push pipesY+2 ; y-coordinate address of pipe
   885 0000079A 68[4600]                    push pipesX+2 ; x-coordinate address of pipe
   886 0000079D E8AEFC                      call movePipe
   887 000007A0 6A01                        push 1
   888 000007A2 FF36[4800]                  push word [pipesY] ; x-coordinate of pipe
   889 000007A6 FF36[4400]                  push word [pipesX] ; y-coordinate of pipe
   890 000007AA E821FC                      call defDrawPipe
   891 000007AD 6A01                        push 1
   892 000007AF FF36[4A00]                  push word [pipesY+2] ; x-coordinate of pipe
   893 000007B3 FF36[4600]                  push word [pipesX+2] ; y-coordinate of pipe
   894 000007B7 E814FC                      call defDrawPipe
   895 000007BA 6A00                        push 0
   896 000007BC FF36[4E00]                  push word [leftOverPipeY]
   897 000007C0 6A00                        push 0
   898 000007C2 E809FC                      call defDrawPipe
   899 000007C5 E87AFF                  	call ground_mover
   900                                  		;call music
   901 000007C8 EBA4                    jmp main_loop ; Repeat the main loop
   902 000007CA C3                      	ret
   903                                  sound:
   904 000007CB 60                          pusha                       ; Save all general-purpose registers
   905 000007CC 1E                          push ds                     ; Save DS
   906 000007CD 06                          push es                     ; Save ES
   907 000007CE 16                          push ss                     ; Save SS
   908 000007CF B800A0                      mov ax, 0xA000              ; Video memory segment
   909 000007D2 8EC0                        mov es, ax                  ; Use ES for potential screen updates (if needed)
   910                                  
   911                                  infinite_sound_loop:
   912 000007D4 B0B6                        mov al, 182                 ; Command to set frequency mode
   913 000007D6 E643                        out 43h, al
   914 000007D8 BBDC34                      mov bx, 1193180             ; Base frequency of 1.19318 MHz
   914          ******************       warning: word data exceeds bounds [-w+number-overflow]
   915 000007DB F7F3                        div bx                      ; Calculate divisor for desired frequency
   916 000007DD E642                        out 42h, al                 ; Low byte of divisor to timer
   917 000007DF 88E0                        mov al, ah
   918 000007E1 E642                        out 42h, al                 ; High byte of divisor to timer
   919                                  
   920                                      ; Enable the speaker
   921 000007E3 E461                        in al, 61h                  ; Read speaker control register
   922 000007E5 0C03                        or al, 00000011b            ; Enable speaker
   923 000007E7 E661                        out 61h, al
   924                                  
   925                                      ; Optional delay or loop (minimal)
   926 000007E9 90                          nop                         ; Use NOP or a small delay instead of an infinite loop
   927 000007EA 90                          nop
   928                                  
   929                                      ; Disable the speaker
   930 000007EB E461                        in al, 61h
   931 000007ED 24FC                        and al, 11111100b           ; Disable speaker
   932 000007EF E661                        out 61h, al
   933 000007F1 EBE1                        jmp infinite_sound_loop
   934                                  
   935                                  sound_exit:
   936 000007F3 17                          pop ss                      ; Restore SS
   937 000007F4 07                          pop es                      ; Restore ES
   938 000007F5 1F                          pop ds                      ; Restore DS
   939 000007F6 61                          popa                        ; Restore all general-purpose registers
   940 000007F7 C3                          ret                         ; Return to caller
   941                                  prrint:
   942 000007F8 FF06[6B00]              inc word [score]
   943 000007FC E8CCFF                  call sound
   944 000007FF EBF7                    jmp prrint
   945                                  start:
   946                                  
   947 00000801 E8C1F9                   call DisplayIntroduction 
   948 00000804 B400                     mov ah,0
   949 00000806 CD16                     int 16h
   950 00000808 80FC01                   cmp ah,0x01
   951 0000080B 0F8478FA                 je exit_game
   952 0000080F E849FF                   call PrintStartScreen 
   953 00000812 31C0                         xor ax, ax
   954 00000814 8EC0                         mov es, ax
   955 00000816 FA                           cli
   956 00000817 26A12000                	 mov ax, word[es:8*4]
   957 0000081B A3[7500]                	 mov word [oldtimer],ax
   958 0000081E 26A12200                	 mov ax,word[es:8*4+2]
   959 00000822 A3[7700]                	 mov word[oldtimer+2],ax
   960 00000825 26C7062000[6608]             mov word [es:8*4], timer
   961 0000082C 268C0E2200                   mov [es:8*4+2], cs
   962 00000831 FB                           sti
   963                                  
   964                                  ll1:
   965 00000832 C706[B001][CB07]             mov word [pcb+10+4], sound         ; Game logic thread
   966 00000838 8C0E[B201]                   mov [pcb+10+6], cs
   967 0000083C C706[B401]0002               mov word [pcb+10+8], 0x0200    
   968 00000842 C706[BA01][6B07]             mov word [pcb+20+4], anime  ; Music thread
   969 00000848 8C0E[BC01]                   mov [pcb+20+6], cs
   970 0000084C C706[BE01]0002               mov word [pcb+20+8], 0x0200         ; Flags
   971 00000852 C706[B601]0000               mov word [current], 0               ; Start with the first task
   972 00000858 EBD8                    	 jmp ll1
   973                                  	 ll2:
   974 0000085A 833E[6D00]01            	 cmp word[game_end] ,1
   975 0000085F 7400                    	 je exxxxit
   976                                  	 exxxxit:
   977 00000861 B8004C                   mov ax, 0x4C00
   978 00000864 CD21                    int 0x21
   979                                  timer:
   980 00000866 0E                      	push cs 
   981 00000867 1F                      pop ds
   982 00000868 50                        push ax
   983 00000869 53                       push bx
   984 0000086A 2E8A1E[B601]             mov bl, [cs:current] ; read index of current task ... bl
   985 0000086F B80A00                   mov ax, 10 ; space used by
   986 00000872 F6E3                     mul bl ; multiply to get
   987 00000874 89C3                     mov bx, ax ; load start of
   988 00000876 58                       pop ax ; read origina
   989                                  
   990 00000877 2E8987[A401]             mov [cs:pcb+bx+2], ax ; space for current task's BX
   991 0000087C 58                       pop ax ; read original
   992 0000087D 2E8987[A201]             mov [cs:pcb+bx+0], ax ; space for current task's AX
   993 00000882 58                       pop ax ; read original
   994 00000883 2E8987[A601]             mov [cs:pcb+bx+4], ax ; space for current task
   995 00000888 58                       pop ax ; read original
   996 00000889 2E8987[A801]             mov [cs:pcb+bx+6], ax ; space for current task
   997 0000088E 58                       pop ax ; read original
   998 0000088F 2E8987[AA01]             mov [cs:pcb+bx+8], ax ; space for current task
   999 00000894 2EFE06[B601]             inc byte [cs:current] ; update current task index...1
  1000 00000899 2E803E[B601]03           cmp byte [cs:current], 3; is task index out of range
  1001 0000089F 7506                     jne skipreset ; no, proceed
  1002 000008A1 2EC606[B601]00           mov byte [cs:current], 0 ; yes, reset to task 0
  1003                                   skipreset: 
  1004 000008A7 2E8A1E[B601]             mov bl, [cs:current] ; read index of current task
  1005 000008AC B80A00                   mov ax, 10 ; space used by
  1006 000008AF F6E3                     mul bl ; multiply to get
  1007 000008B1 89C3                     mov bx, ax ; load start of
  1008 000008B3 B020                     mov al, 0x20
  1009 000008B5 E620                     out 0x20, al ; send EOI to PIC
  1010 000008B7 2EFFB7[AA01]             push word [cs:pcb+bx+8] ; flags of new task...
  1011 000008BC 2EFFB7[A801]             push word [cs:pcb+bx+6] ; cs of new task ...
  1012 000008C1 2EFFB7[A601]             push word [cs:pcb+bx+4] ; ip of new task...
  1013 000008C6 2E8B87[A201]             mov ax, [cs:pcb+bx+0] ; ax of new task...pcb+10+0
  1014 000008CB 2E8B9F[A401]             mov bx, [cs:pcb+bx+2] ; bx of new task...pcb+10+2
  1015 000008D0 CF                       iret ; return to new
